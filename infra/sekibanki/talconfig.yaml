---
clusterName: sekibanki
talosVersion: v1.11.3
kubernetesVersion: v1.34.1
endpoint: https://10.0.0.32:6443
domain: sekibanki.prettysunflower.moe
allowSchedulingOnControlPlanes: true
clusterPodNets:
  - 10.217.0.0/16
clusterSvcNets:
  - 10.218.0.0/16
patches:
  - "@./tailscale.patch.yaml"
  - |-
    machine:
      network:
        kubespan:
          enabled: true
      features:
        hostDNS:
          forwardKubeDNSToHost: false
      kubelet:
        extraArgs:
          rotate-server-certificates: true
      registries:
        mirrors:
          docker.io:
            endpoints:
              - https://mirror.container.sunflower.lgbt
          gcr.io:
            endpoints:
              - https://mirror.container.sunflower.lgbt
          ghcr.io:
            endpoints:
              - https://mirror.container.sunflower.lgbt
          registry.k8s.io:
            endpoints:
              - https://mirror.container.sunflower.lgbt

nodes:
  - hostname: fulgora
    ipAddress: 10.0.0.32
    controlPlane: true
    installDisk: /dev/sda
  - hostname: gleba
    ipAddress: 10.0.0.30
    controlPlane: true
    installDisk: /dev/sda
  - hostname: vulcanus
    ipAddress: 10.0.0.33
    controlPlane: true
    installDisk: /dev/sda

controlPlane:
  schematic:
    customization:
      systemExtensions:
        officialExtensions:
          - siderolabs/iscsi-tools
          - siderolabs/qemu-guest-agent
          - siderolabs/tailscale
          - siderolabs/util-linux-tools

worker:
  schematic:
    customization:
      systemExtensions:
        officialExtensions:
          - siderolabs/iscsi-tools
          - siderolabs/qemu-guest-agent
          - siderolabs/tailscale
          - siderolabs/util-linux-tools
